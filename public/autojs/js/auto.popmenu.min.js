!function(e){e.autopopmenu=null,e.fn.autopopmenu=function(n){e.autopopmenu=this;var o=this;menu=e(n.menu),menu.hasClass("popmenu")||menu.addClass("popmenu"),menu.hasClass("popover")||menu.addClass("popover"),o.reset=function(){for(var e=i.length;e>1;e--)i.pop();menu.find("ul").hide(),u=t},o.hide=function(){o.reset(),o.autopopover("hide"),n.hide&&n.hide()};var t=menu.find("> ul").eq(0),i=[t],u=t;return o.back=function(){i.pop();menu.find("> ul:visible").hide(),u=i[i.length-1],u.show()},o.show=function(n){n.length>0&&(u.hide(),0===n.find("a.back").length&&n.prepend(e('<li><a class="back" onclick="$.autopopmenu.back()"><i class="fa fa-chevron-left pull-left"></i>back</a></li>')),u=n.show(),i.push(u))},menu.find("a.back").on("click",function(){o.back()}),menu.find("li a").on("click",function(n){var t=e(this),i=e(t.data("menu"));return o.show(i),"file"!=n.target.type?(n.preventDefault(),!1):void 0}),menu.on("click",function(e){return"file"!=e.target.type?(e.preventDefault(),!1):void 0}),this.each(function(){e(this).autopopover({popover:n.menu,position:n.position||"bottom center",trigger:"manual"}),e(this).on("click",function(i){return o.reset(),t.show(),e(this).autopopover("show"),n.show&&n.show({source:e(this)}),"file"!=i.target.type?(i.preventDefault(),!1):void 0})})}}(jQuery);